%Event_Global
    Event
        On Global
%Event_Team(team_)
    Event
        On Each Player
        team_
        All
%Portal(pos, type_, color_, name_)
    Create Effect
        Visible_To: Everyone
        Type: type_
        Color: color_
        Position: pos
        Radius: 1.5
        Reevaluation: Visible To
%UpgradePortal(pos)
    Portal(pos, Good Aura, Yellow, "Upgrades")
    portals.push(pos)
%ShopPortal(pos)
    Portal(pos, Good Aura, Purple, `{0} {1}`("Previous", "Boss"))
    shop_portal = pos
%UpgradeEffect(pos, cost, cost_rate, color_)
    Create Effect
        Visible_To: Everyone
        Type: Light Orb
        Color: color_
        Position: pos
        Radius: 1.5
        Reevaluation: Visible To

Rule "Initialize Constants"
    Event_Global()
    Actions
        /* Global Variables */
        shop_pos = <2.500, 3.500, 75>
        player_spawns = [<-40, 0, 145.5>, <-29, 8, 56>, <-77.5, 1.5, 65.5>, <-50.5, 1.5, 117>, <43.5, 3.5, 73.5>, <-115, 1.5, 112.5>]
        boss_spawns = [<-31.5, 0, 148>, <-22.5, 7.5, 66.5>, <-82.5, 1.5, 61>, <-59, 1, 104>, <53.5, 3.5, 72.5>, <-129, 2.5, 108.5>]
        boss_heroes = [Hero(Roadhog), Hero(Soldier: 76), Hero(Mei), Hero(Lucio), Hero(Ana), Hero(Reaper)]
        boss2_boundary = <-29, -2, 56>
        boss4_boundary = <-54, 1, 109>
        Pause Match Time
        Set Match Time(123)

Rule "Initialize Player Stats"
    Event_Team(All)
    Actions
        /* Player Variables */
        pvar location = 0
        pvar cur_boss = 0
        pvar bosses_killed = 0
        pvar money = 0
        pvar damage_scale = 1
        pvar damage_scale_cost = -1
        pvar reload_speed = 2.0
        pvar reload_speed_cost = -1
        pvar money_multiplier = -1
        pvar money_multiplier_cost = -1
        pvar hp = -1
        pvar hp_cost = -1
        pvar defense = -1
        pvar defense_cost = -1
        pvar ability1 = False
        pvar ability2 = False
        pvar credits = 0

Rule "Validate Bosses"
    Event_Global()
    Conditions
        All True
            boss_heroes
            Array Contains
                All Players
                    Team 2
                Cur Elem
        == False
    Actions
        Msg
            `{0}: {1}`
                "Warning"
                `{0} {1}`
                    "Bad"
                    "Bosses"
        Wait(1.5s)
        Loop If Condition Is True